<script>
let carrito = JSON.parse(localStorage.getItem("carrito")) || [];

function guardar() {
  localStorage.setItem("carrito", JSON.stringify(carrito));
}

function mostrar() {
  const lista = document.getElementById("lista");
  const totalSpan = document.getElementById("total");

  lista.innerHTML = "";
  let total = 0;

  carrito.forEach(p => {
    total += p.precio * p.cantidad;

    lista.innerHTML += `
      <li>
        <strong>${p.nombre}</strong><br>
        
        <button onclick="cambiarCantidad('${p.nombre}', -1)">‚ûñ</button>
        <span style="margin:0 10px;">${p.cantidad}</span>
        <button onclick="cambiarCantidad('${p.nombre}', 1)">‚ûï</button>
        
        <br>
        $${p.precio * p.cantidad}
        
        <button class="borrar" onclick="eliminar('${p.nombre}')">üóëÔ∏è</button>
        <hr>
      </li>
    `;
  });

  totalSpan.innerText = total;
}

function cambiarCantidad(nombre, cambio) {
  carrito = carrito.map(p => {
    if (p.nombre === nombre) {
      p.cantidad += cambio;

      if (p.cantidad < 1) {
        p.cantidad = 1;
      }
    }
    return p;
  });

  guardar();
  mostrar();
}

function eliminar(nombre) {
  carrito = carrito.filter(p => p.nombre !== nombre);
  guardar();
  mostrar();
}

function enviar() {
  if (carrito.length === 0) {
    alert("La canasta est√° vac√≠a");
    return;
  }

  let mensaje = "üõí *Pedido Supervin*%0A%0A";
  let total = 0;

  carrito.forEach(p => {
    mensaje += `‚Ä¢ ${p.nombre} x${p.cantidad} - $${p.precio * p.cantidad}%0A`;
    total += p.precio * p.cantidad;
  });

  mensaje += `%0A*Total:* $${total}`;

  window.open(
    "https://wa.me/527771537270?text=" + mensaje,
    "_blank"
  );
}

function volver() {
  window.top.location.href =
    "https://sites.google.com/view/pintumex-sol/arquitectonico/vinilica/supervin/210-blanco-ostion";
}

document.addEventListener("DOMContentLoaded", mostrar);
</script>
